new entry "Boomingblade_Passive"
type "PassiveData"
data "DisplayName" "Booming Blade"
data "Description" "If target willingly moves before the end of their turn, they take 1d8 thunder damage."
data "DescriptionParams" "DealDamage(1d8,Thunder)"
data "StatsFunctors" "DealDamage(SELF,2d8,Thunder); RemoveStatus(SELF,BOOMINGBLADE_TARGET_2)"
data "StatsFunctorContext" "OnMoveStartedInCombat"

new entry "Status_ZephyrStrikeSpeedAttackBonus"
type "PassiveData"
data "DisplayName" "Zephyr Strike"
data "Description" "Once during the spell's activation, one weapon attack gains advantage against a target and deals an additional 1d8 Force damage. Whether it hits or misses, you gain an additional 9 movement for the turn."
data "PassiveFlags" "ExecuteOnce"
data "Conditions" "IsWeaponAttack() or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack or context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack"
data "Boosts" "Advantage(AttackRoll)"
data "StatsFunctors" "IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack):DealDamage(1d8,Force);IF(context.HitDescription.AttackType==AttackType.RangedWeaponAttack):DealDamage(1d8,Force);IF(context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(1d8,Force);IF(context.HitDescription.AttackType==AttackType.RangedOffHandWeaponAttack):DealDamage(1d8,Force);ApplyStatus(SELF,ZEPHYR_STRIKE_SPEED,100,1);RemoveStatus(SELF,ZEPHYR_STRIKE_SECOND)"
data "StatsFunctorContext" "OnAttack"

new entry "Shield"
type "PassiveData"
data "DisplayName" "Shield"
data "Description" "When hit by an attack or targeted by the Magic Missile spell, until the start of your next turn, you have a +5 bonus to AC and you take no damage from Magic Missile."
data "ExtraDescription" "Passive_Shield_ExtraDescription"
data "Icon" "Spell_Abjuration_ShieldOfFaith"
data "Conditions" "HasActionResource('ReactionActionPoint', 1, 0, false, context.Source) and (IsAttack() or SpellId('Projectile_MagicMissile'))"
data "Properties" "IsToggled;ToggledDefaultAddToHotbar;ToggledDefaultOn"
data "StatsFunctors" "UseActionResource(SELF, ReactionActionPoint,1);RemoveStatus(SELF,SHIELD_APPLY)"
data "StatsFunctorContext" "OnAttacked"
data "ToggleOnFunctors" "ApplyStatus(SHIELD_TOGGLE,100,-1)"

new entry "AbsorbElements_Acid"
type "PassiveData"
data "Properties" "IsHidden"
data "Conditions" "HasActionResource('ReactionActionPoint', 1, 0, false, context.Target) and (SpellId('Projectile_AcidArrow') or SpellId('Projectile_AcidSplash') or SpellId('Projectile_AcidSplash_Goblin') or SpellId('Projectile_ArrowOfAcid') or SpellId('Projectile_ToxicSplit_Bulette') or SpellId('Projectile_FOR_Ogre_AcidArrow') or SpellId('Target_Bufotoxin_Frog_Summon')) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(ACIDDAMAGE,100,1)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_Fire"
type "PassiveData"
data "Properties" "IsHidden"
data "Conditions" "HasActionResource('ReactionActionPoint', 1, 0, false, context.Target) and (SpellId('Projectile_FireBolt') or SpellId('Projectile_FireBolt_NoRecharged') or SpellId('Projectile_FireBolt_Goblin') or SpellId('Projectile_HellishRebuke') or SpellId('Projectile_HellishRebuke_2') or SpellId('Projectile_ScorchingRay') or SpellId('Projectile__ScorchingRay_LightCleric') or SpellId('Projectile_ScorchingRay_CircletOfBlasting') or SpellId('Projectile_ArrowOfFire') or SpellId('ProjectileBomb') or SpellId('Projectile_Barrel_Explosion') or SpellId('Projectile_Barrel_Explosion_Smokepowder') or SpellId('Projectile_Bag_Smokepowder') or SpellId('Projectile_BoilingWater') or SpellId('Projectile_Generic_Imp') or SpellId('Projectile_Fireball_Trap') or SpellId('Projectile_Fireball_Trap_Easy') or SpellId('Projectile_Fireball_Trap_Hard') or SpellId('Projectile_Grenade_Bomb') or SpellId('Projectile_HAG_HagGrenade_Fire') or SpellId('Projectile_GOB_CageTrap') or SpellId('Projectile_FOR_Ogre_FireBolt') or SpellId('Projectile_UND_Wand_Fireball_Crooked_Spell') or SpellId('Shout_GOB_DetonateSelf') or SpellId('Target_Exhale_Fire') or SpellId('Target_Bite_Gnoll') or SpellId('Target_Claws_Mephit_Magma') or SpellId('Zone_BurningHands') or SpellId('Zone_BurningHands_2') or SpellId('Zone_BurningHands_3') or SpellId('Zone_BurningHands_LightCleric') or SpellId('Zone_BurningHands_LightCleric_2') or SpellId('Zone_BurningHands_LightCleric_3') or SpellId('Zone_BurningHands_MephistophelesTiefling') or SpellId('Zone_PLA_Chokepoint_DragonBreath') or SpellId('Zone_PLA_StuckHalfElf_Backdraft')) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(FIREDAMAGE,100,1)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_Cold"
type "PassiveData"
data "Properties" "IsHidden"
data "Conditions" "HasActionResource('ReactionActionPoint', 1, 0, false, context.Target) and (SpellId('Projectile_RayOfFrost') or SpellId('Projectile_ArrowOfIce') or SpellId('Projectile_SHA_Nightsong_RayOfFrost')) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(COLDDAMAGE,100,1)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_Lightning"
type "PassiveData"
data "Properties" "IsHidden"
data "Conditions" "HasActionResource('ReactionActionPoint', 1, 0, false, context.Target) and (SpellId('Projectile_WitchBolt') or SpellId('Projectile_WitchBolt_2') or SpellId('Projectile_ArrowOfLightning') or SpellId('Projectile_SynapticDischarge_IntDev') or SpellId('Projectile_SHA_Nightsong_WitchBolt') or SpellId('Shout_StaticOverdrive_Automaton') or SpellId('Target_ShockingGrasp') or SpellId('Target_WitchBolt_Activate') or SpellId('Target_GOB_Priestess_ShockingGrasp')) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(LIGHTNINGDAMAGE,100,1)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_Thunder"
type "PassiveData"
data "Properties" "IsHidden"
data "Conditions" "HasActionResource('ReactionActionPoint', 1, 0, false, context.Target) and (SpellId('Target_Shatter') or SpellId('Zone_Thunderwave') or SpellId('Zone_Thunderwave_2') or SpellId('Zone_PLA_StuckHalfElf_Backdraft') or SpellId('Zone_GOB_Priestess_Thunderwave') or SpellId('Zone_DEN_Halsin_Thunderwave')) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "ApplyStatus(THUNDERDAMAGE,100,1)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_AcidAttack"
type "PassiveData"
data "DisplayName" "Absorb Elements: Acid"
data "Properties" "OncePerTurn"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(1d6,Acid)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_FireAttack"
type "PassiveData"
data "DisplayName" "Absorb Elements: Fire"
data "Properties" "OncePerTurn"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(1d6,Fire)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_ColdAttack"
type "PassiveData"
data "DisplayName" "Absorb Elements: Cold"
data "Properties" "OncePerTurn"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(1d6,Cold)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_LightningAttack"
type "PassiveData"
data "DisplayName" "Absorb Elements: Lightning"
data "Properties" "OncePerTurn"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(1d6,Lightning)"
data "StatsFunctorContext" "OnAttack"

new entry "AbsorbElements_ThunderAttack"
type "PassiveData"
data "DisplayName" "Absorb Elements: Thunder"
data "Properties" "OncePerTurn"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(1d6,Thunder)"
data "StatsFunctorContext" "OnAttack"

new entry "Compelled_Duel"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctors" "IF(not HasStatus('COMPELLED_DUEL')):RemoveStatus(SELF,COMPELLED_DUEL_CASTER)"
data "StatsFunctorContext" "OnAttack"

new entry "BeaconOfHope"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctors" "RegainHitPoints(1)"
data "StatsFunctorContext" "OnHeal"

new entry "ThunderousSmite"
type "PassiveData"
data "DisplayName" "Thunderous Smite"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(2d6,Thunder);IF(not Item() and not SavingThrow(Ability.Strength, SourceSpellDC() and context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):Force(3);IF(not Item() and context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):ApplyStatus(PRONE, 100, 1, , , ,not SavingThrow(Ability.Strength, SourceSpellDC()));IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):RemoveStatus(SELF,THUNDEROUS_SMITE)"
data "StatsFunctorContext" "OnAttack"

new entry "Wrathful_Smite"
type "PassiveData"
data "DisplayName" "Wrathful Smite"
data "Conditions" "(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack) and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "IF(context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):DealDamage(1d6,Psychic);IF(not Item() and context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):ApplyStatus(FRIGHTENED, 100, 10, , , ,not SavingThrow(Ability.Wisdom, SourceSpellDC()));IF(not Item() and context.HitDescription.AttackType==AttackType.MeleeWeaponAttack or context.HitDescription.AttackType==AttackType.MeleeOffHandWeaponAttack):ApplyStatus(FRIGHTENED_CHECK, 100, 10, , , ,not SavingThrow(Ability.Wisdom, SourceSpellDC()));RemoveStatus(SELF,WRATHFUL_SMITE)"
data "StatsFunctorContext" "OnAttack"

new entry "ShadowBlade_Advantage"
type "PassiveData"
data "Conditions" "IsPassiveSource('ShadowBlade_Advantage', GetAttackWeapon()) and IsWeaponAttack()"
data "DisplayName" "Shadow Blade"
data "Description" "You gain advantage against targets in dim light or darkness."
data "Boosts" "IF(HasStatus('SNEAKING_LIGHTLY_OBSCURED',context.Target)):Advantage(AttackRoll);IF(HasStatus('SNEAKING_HEAVILY_OBSCURED',context.Target)):Advantage(AttackRoll)"
data "BoostConditions" "IsPassiveSource('ShadowBlade_Advantage', GetAttackWeapon()) and IsWeaponAttack()"
data "BoostContext" "OnAttack"

new entry "ElementalWeapon"
type "PassiveData"
data "DisplayName" "Elemental Weapon"
data "Boosts" "RollBonus(MeleeWeaponAttack,1)"
data "BoostConditions" "IsPassiveSource('ElementalWeapon', GetAttackWeapon())"
data "BoostContext" "OnAttack"

new entry "Curse_ExtraDamage"
type "PassiveData"
data "DisplayName" "Curse: Extra Damage"
data "Description" "You take an additional 1d8 Necrotic damage from the caster's attacks."
data "Conditions" "HasStatus('CURSE_EXTRADAMAGE_CASTER') and HasDamageEffectFlag(DamageFlags.Hit)"
data "StatsFunctors" "DealDamage(SELF,1d6,Necrotic)"
data "StatsFunctorContext" "OnAttacked"

new entry "DispelMagic_Proc"
type "PassiveData"
data "Properties" "IsHidden"
data "Conditions" "context.HitDescription.SpellLevel < 4"
data "StatsFunctors" "ApplyStatus(SELF,DISPELMAGIC_ACTIVE,100,-1);ApplyStatus(DISPELMAGIC_ACTIVE,100,-1)"
data "StatsFunctorContext" "OnAttack;OnHeal"

new entry "FlamingSphere_State_2"
type "PassiveData"
data "DisplayName" "Passive_FlamingSphere_State_DisplayName"
data "Description" "Passive_FlamingSphere_State_Description"
data "DescriptionParams" "DealDamage(3d6,Fire)"
data "Icon" "Spell_Conjuration_FlamingSphere"
data "Properties" "IsToggled;ToggledDefaultOn;ToggledDefaultAddToHotbar"
data "ToggleOnFunctors" "ApplyStatus(FLAMING_SPHERE_AURA_2,100,-1)"
data "ToggleOffFunctors" "RemoveStatus(FLAMING_SPHERE_AURA_2)"